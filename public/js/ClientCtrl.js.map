{"version":3,"sources":["ClientCtrl.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ClientCtrl.js","sourcesContent":["/**\n * Created by akramkhalifa on 29/08/2016.\n */\n'use strict';\n\n/**\n * @ngdoc function\n * @name demoApp.controller:IndexCtrl\n * @description\n * # IndexCtrl\n * Controller of the demoApp\n */\nhrmApp\n    .controller('ClientCtrl',['ClientService','$http','$mdEditDialog', '$scope','$mdDialog','$timeout','$mdBottomSheet', '$mdToast',\n        function (\n            ClientService,$http,$mdEditDialog, $scope,$mdDialog, $timeout,$mdBottomSheet, $mdToast) {\n\n            $scope.rasions =  $http({\n                            method: 'GET',\n                            url: 'http://localhost/hrm/public/api/raisons'\n                            }).success(function (data) {\n                                    $scope.rasions = data;\n                            }).error(function (data) {\n                                console.log(data);\n                        });\n\n            $scope.selectedRasions;\n            $scope.getselectedRasions = function() {\n                if ($scope.selectedRasions !== undefined) {\n                    return  $scope.selectedRasions;\n                } else {\n                    return \"Raison Sociale\";\n                }\n            };\n\n        /* select villes */\n\n            $scope.villes = [\" \",\"RABAT\", \"CASABLANCA\", \"TANGER\", \"FES\", \"Salé\", \"Marrakech\", \"Meknes\"];\n            $scope.selectedVilles;\n            $scope.getselectedVilles = function() {\n                if ($scope.selectedVilles !== undefined) {\n                    return  $scope.selectedVilles;\n                } else {\n                    return \"Ville\";\n                }\n            };\n\n        /* delete row in table*/\n\n            var bookmark;\n\n            $scope.errors = [];\n\n            $scope.id = null;\n            $scope.clients = [];\n            $scope.huge = [];\n\n            $scope.selected = [];\n            $scope.limitOptions = [5, 10, 15, {\n                label: 'All',\n                value: function () {\n                    return $scope.clients ? $scope.clients.count : 0;\n                }\n            }];\n\n            $scope.options = {\n                rowSelection: true,\n                multiSelect: true,\n                autoSelect: true,\n                decapitate: false,\n                largeEditDialog: false,\n                boundaryLinks: false,\n                limitSelect: true,\n                pageSelect: true\n            };\n\n            $scope.query = {\n                order: 'raison',\n                limit: 5,\n                page: 1\n            };\n\n\n            $scope.init = function () {\n                ClientService.getClients().$promise.then(function (data) {\n                        $scope.clients = {\n                         \"count\":data.length,\n                         \"data\":data\n                         };\n                });\n                $scope.rasions =  $http({\n                    method: 'GET',\n                    url: 'http://localhost/hrm/public/api/raisons'\n                }).success(function (data) {\n                    $scope.rasions = data;\n                }).error(function (data) {\n                    console.log(data);\n                });\n            };\n\n\n            $scope.deselect = function (item) {\n                console.log(item.id,'was deselected');\n            };\n\n            $scope.oneClient = {};\n\n            $scope.id = 0;\n\n            $scope.log = function (item) {\n                console.log(item.id,'was selected');\n                $scope.id = item.id;\n            };\n\n\n            $scope.loadStuff = function () {\n                $scope.promise = $timeout(function () {\n\n                }, 2000);\n            };\n\n            $scope.toggleLimitOptions = function () {\n                $scope.limitOptions = $scope.limitOptions ? undefined : [5, 10, 15];\n            };\n\n            $scope.loadStuff = function () {\n                $scope.promise = $timeout(function () {\n                    // loading\n                }, 2000);\n            };\n\n            $scope.logPagination = function (page, limit) {\n                console.log('page: ', page);\n                console.log('limit: ', limit);\n            };\n\n            $scope.client = {};\n\n            $scope.addClient = function (event) {\n                $mdDialog.show({\n                    controller: AddClientController,\n                    locals: {\n                        items: $scope.clients, errors: $scope.errors\n                    },\n                    parent: angular.element(document.body),\n                    templateUrl: 'views/client/addclient.html',\n                    controllerAs: 'ctrl',\n                    clickOutsideToClose:true,\n                    targetEvent: event\n                }).then(function (add) {\n                   $scope.init();\n                }, function(cancel) {\n                });\n            };\n\n            $scope.showClient = function (event) {\n                    $mdDialog.show({\n                        locals: {\n                            id: $scope.id\n                        },\n                        controller: function ($mdDialog,$scope,id) {\n                            ClientService.getClient({id: id}).$promise.then(function (data) {\n                                angular.forEach(data,function (value) {\n                                     $scope.datas = value;\n                                });\n                            });\n                            $scope.hide = function () {\n                                $mdDialog.hide();\n                            };\n                            $scope.cancel = function () {\n                                $mdDialog.cancel();\n                            };\n                        },\n                        parent: angular.element(document.body),\n                        templateUrl: 'views/client/seeClient.html',\n                        clickOutsideToClose:true,\n                        targetEvent: event\n                    });\n            };\n\n            $scope.editClient = function (event) {\n                $mdDialog.show({\n                    controller: EditClientController,\n                    parent: angular.element(document.body),\n                    templateUrl: 'views/client/editClient.html',\n                    locals: {\n                        items: $scope.clients,id: $scope.id\n                    },\n                    clickOutsideToClose:true,\n                    targetEvent: event\n                }).then(function (edit) {\n                    $scope.init();\n                    $mdToast.show(\n                        $mdToast.simple()\n                            .textContent(\"Client modifié avec succès\")\n                            .position('top right')\n                            .hideDelay(1500)\n                    );\n\n                }, function(cancel) {\n                });\n            };\n\n            function AddClientController($scope, $mdDialog,items,errors) {\n                $scope.hide = function () {\n                    $mdDialog.hide();\n                };\n                $scope.cancel = function () {\n                    $mdDialog.cancel();\n                };\n                $scope.add = function (client) {\n                    if(client.raison != null){\n                        client = {\n                            raisonSoc : client.raison,\n                            add: client.addresse || \" \",\n                            ville: client.ville || \" \",\n                            email: client.email || \" \",\n                            tel: client.tel|| \" \",\n                            nomResp: client.name_resp || \" \"\n                        };\n                        ClientService.saveClient(client).$promise.then(\n                            function(value) {\n                                items.push.data(value);\n                            },function (data) {\n                                errors.push(data);\n                                console.log(data);\n                            });\n                        $mdDialog.hide(client);\n                    }\n                   else {\n                       console.log(\"wj-hat\");\n                   }\n                };\n            };\n\n            function EditClientController($scope, $mdDialog,items,id) {\n                $scope.hide = function () {\n                    $mdDialog.hide();\n                };\n                $scope.cancel = function () {\n                    $mdDialog.cancel();\n                };\n                ClientService.getClient({id: id}).$promise.then(function (data) {\n                    angular.forEach(data,function (value) {\n                        $scope.datas = value;\n                    })\n                });\n                $scope.edit = function (client) {\n                    client = {\n                        raisonSoc : client.raison,\n                        add: client.addresse,\n                        ville: client.ville,\n                        email: client.email,\n                        tel: client.tel,\n                        nomResp: client.name_resp\n                    };\n                    ClientService.editClient({id: id},client);\n                    $mdDialog.hide(client);\n                }\n            }\n\n            // a des mission auxquelles il est relié. Ces missions doivent étre supprimées avant de supprimer ce client\n\n            $scope.showConfirm = function(ev) {\n                var confirm = $mdDialog.confirm()\n                    .title('Vous voulez vraiment supprimer?')\n                    .textContent('Ce client')\n                    .targetEvent(ev)\n                    .ok('Effacer')\n                    .cancel('Annuler');\n                $mdDialog.show(confirm).then(function() {\n                     var index =  $scope.clients[\"data\"].indexOf(\n                         $scope.clients[\"data\"].find(function(e) {\n                         return e.id == $scope.id;\n                     }));\n\n                    ClientService.deleteClient({id: $scope.id}).$promise.then(function (success) {\n                        $scope.clients[\"data\"].splice(index,1);\n                    });\n\n                    $mdToast.show(\n                        $mdToast.simple()\n                            .textContent(\"Le client a été supprimé\")\n                            .position('top right')\n                            .hideDelay(1500)\n                    );\n                }, function() {\n                });\n            };\n            $scope.init();\n\n            $scope.serachClient = function () {\n                $http({\n                    method: 'POST',\n                    url: 'http://localhost/hrm/public/api/searchClient',\n                    data:  {raisonSoc: $scope.selectedRasions, ville: $scope.selectedVilles}\n                }).success(function (data) {\n                   // console.log(data.match('No Clinet Found'));\n                    if(data != 'No Clinet Found'){\n                        $scope.clients[\"data\"] = [];\n                        $scope.clients[\"data\"].push(data);\n                    }\n                    else {\n                        $scope.init();\n                    }\n                }).error(function (data) {\n                    console.log(data);\n                });\n\n\n            }\n        }\n    ]);\n\n"],"sourceRoot":"/source/"}