{"version":3,"sources":["AdminCtrl.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AdminCtrl.js","sourcesContent":["/**\n * Created by akramkhalifa on 03/09/2016.\n */\n/**\n * Created by akramkhalifa on 29/08/2016.\n */\n'use strict';\n\n/**\n * @ngdoc function\n * @name demoApp.controller:IndexCtrl\n * @description\n * # IndexCtrl\n * Controller of the demoApp\n */\nhrmApp\n    .controller('AdminCtrl',['$http','$localStorage','$rootScope','$mdEditDialog', '$q', '$scope','$mdDialog','$timeout','$mdBottomSheet', '$mdToast',\n        function (\n            $http,$localStorage,$rootScope,$mdEditDialog, $q, $scope,$mdDialog, $timeout,$mdBottomSheet, $mdToast) {\n\n            $scope.isRole = [];\n            $scope.permsAll = [];\n            $scope.users = [];\n\n             $scope.init = function () {\n                 var x = JSON.parse($localStorage.currentUser);\n                    $http({\n                        method: 'GET',\n                        url: 'http://localhost/hrm/public/getUsers'\n                    }).success(function (data) {\n                        angular.forEach(data, function(item){\n                            $scope.users.push(item);\n                        });\n                    }).error(function (data) {\n                        console.log(data);\n                    });\n\n                $http({\n                   method: 'POST',\n                   url: 'http://localhost/hrm/public/checkRole',\n                   data:  {email: x.email}\n                   }).success(function (data) {\n\n                       angular.forEach(data, function(item){\n                         //  console.log(item);\n                           $scope.isRole.push(item);\n                       });\n                   }).error(function (data) {\n                       console.log(data);\n                   });\n\n               /* $http({\n                    method: 'PUT',\n                    url: 'http://localhost/hrm/public/api/clients/1',\n                    data: {raisonSoc: 'dddv', add: 'ddf',ville:'akram@dd.com',email:'dd',tel:'es',nomResp:'dsd'}\n                }).success(function (data) {\n                    console.log('user',data);\n                }).error(function (data) {\n                    console.log(data);\n                });*/\n               console.log(x.email);\n            };\n\n            $scope.profilesNames = $http({\n                method: 'GET',\n                url: 'http://localhost/hrm/public/roles'\n            }).success(function (data) {\n                $scope.profilesNames = data;\n            }).error(function (data) {\n                console.log(data);\n            });\n\n            $scope.init();\n\n            $scope.role = '';\n            //clients\n            $scope.addClient = false;\n            $scope.readClient = false;\n            $scope.editClient = false;\n            $scope.removeClient = false;\n\n            //Consultants\n            $scope.addCons = false;\n            $scope.readCons = false;\n            $scope.editCons = false;\n            $scope.removeCons = false;\n\n            //Missions\n            $scope.addMission = false;\n            $scope.readMission = false;\n            $scope.editMission = false;\n            $scope.removeMission = false;\n\n            //Prestations\n            $scope.addPrest = false;\n            $scope.readPrest = false;\n            $scope.editPrest = false;\n            $scope.removePrest = false;\n            //caisse\n\n            $scope.addCahrage = false;\n            $scope.seeCahrage = false;\n            $scope.editCahrage = false;\n            $scope.removeCahrage = false;\n\n            //user\n            $scope.email = '';\n            $scope.password= '';\n            $scope.cpassword = '';\n            //\n            $scope.apassword = '';\n            $scope.npassword = '';\n            $scope.gpassword = '';\n\n            $scope.rest = function () {\n                $scope.x = JSON.parse($localStorage.currentUser);\n                $http({\n                    method: 'POST',\n                    url: 'https://shrm.herokuapp.com/password/reset',\n                    data:  {email: x.email,password: $scope.npassword}\n\n                }).success(function (data) {\n                }).error(function (data) {\n                    console.log(data);\n                });\n\n            };\n\n            $scope.addProfile = function (event) {\n                $mdDialog.show({\n                    controller: DialogController,\n                    parent: angular.element(document.body),\n                    templateUrl: 'views/admin/addProfile.html',\n                    controllerAs: 'ctrl',\n                    clickOutsideToClose:true,\n                    targetEvent: event\n                }).then(function (add) {\n                    $mdToast.show(\n                        $mdToast.simple()\n                            .textContent(\"Profile ajouté avec succès\")\n                            .position('top right')\n                            .hideDelay(1500)\n                    );\n                }, function(cancel) {\n                });\n            };\n\n            $scope.addUser = function (event) {\n                $mdDialog.show({\n                    controller: DialogController,\n                    parent: angular.element(document.body),\n                    templateUrl: 'views/admin/addUser.html',\n                    controllerAs: 'ctrl',\n                    clickOutsideToClose:true,\n                    targetEvent: event\n                }).then(function (addUser) {\n\n                    $mdToast.show(\n                        $mdToast.simple()\n                            .textContent(\"User ajouté avec succès\")\n                            .position('top right')\n                            .hideDelay(1500)\n                    );\n                }, function(cancel) {\n                });\n            };\n\n            function DialogController($scope, $mdDialog) {\n                $scope.profiles = [];\n\n\n                $http({\n                    method: 'GET',\n                    url: 'http://localhost/hrm/public/roles'\n                }).success(function(data){\n                    $scope.profiles  =data;\n                }).error(function(){\n                    alert(\"error\");\n                });\n\n                $scope.selectedItem;\n\n                $scope.getSelectedText = function() {\n                    if ($scope.selectedItem !== undefined) {\n                        return $scope.selectedItem;\n                    } else {\n                        return \"Please select an item\";\n                    }\n                };\n\n                $scope.hide = function () {\n                    $mdDialog.hide();\n                };\n                $scope.cancel = function () {\n                    $mdDialog.cancel();\n                };\n                $scope.addUser = function () {\n                    if($scope.password == $scope.cpassword){\n                        $http({\n                            method: 'POST',\n                            url: 'http://localhost/hrm/public/saveUser',\n                            data:  {email: $scope.email,password: $scope.password}\n                        }).success(function (data) {\n                            $http({\n                                method: 'POST',\n                                url: 'http://localhost/hrm/public/assign-role',\n                                data: {email: $scope.email, name: $scope.selectedItem}\n                            }).success(function (data) {\n                               /* $scope.$on('categoryAdded', function (event, args) {\n                                    $scope.users.push(data);\n                                    console.log($scope.users);\n                                });*/\n                            });\n                        });\n                    }\n                    else  {\n                        console.log(\"password error\");\n                    }\n\n                    $mdDialog.hide();\n                };\n                $scope.add = function () {\n\n                    // permissions\n                    $scope.perms = [];\n\n                    if($scope.addClient == true){\n                        $scope.perms.push('create-client');\n                    }\n                    if($scope.editClient ==true){\n                        $scope.perms.push('edit-client');\n                    }\n                    if($scope.readClient == true){\n                        $scope.perms.push('read-client');\n                    }\n                    if($scope.removeClient == true){\n                        $scope.perms.push('delete-client');\n                    }\n\n                    if($scope.addCons == true){\n                        $scope.perms.push('add-cons');\n                    }\n                    if($scope.editCons == true){\n                        $scope.perms.push('edit-cons');\n                    }\n                    if($scope.readCons == true){\n                        $scope.perms.push('read-cons')\n                    }\n                    if($scope.removeCons == true){\n                        $scope.perms.push('delete-cons');\n                    }\n\n                    if($scope.addMission == true){\n                        $scope.perms.push('add-mission');\n                    }\n                    if($scope.readMission == true){\n                        $scope.perms.push('read-mission');\n                    }\n                    if($scope.editMission == true){\n                        $scope.perms.push('edit-mission');\n                    }\n                    if($scope.removeMission == true){\n                        $scope.perms.push('delete-mission');\n                    }\n\n                    if($scope.addPrest == true){\n                        $scope.perms.push('add-pert');\n                    }\n                    if($scope.editPrest == true){\n                        $scope.perms.push('edit-pert');\n                    }\n                    if($scope.readPrest == true){\n                        $scope.perms.push('read-pert');\n                    }\n                    if($scope.removePrest == true){\n                        $scope.perms.push('delete-pert');\n                    }\n\n                    if($scope.addCahrage == true){\n                        $scope.perms.push('add-caisse');\n                    }\n\n                    if($scope.seeCahrage == true){\n                        $scope.perms.push('edit-caisse');\n                    }\n\n                    if($scope.editCahrage == true){\n                        $scope.perms.push('delete-caisse');\n                    }\n\n                    if($scope.removeCahrage == true){\n                        $scope.perms.push('read-caisse');\n                    }\n\n                    var x = JSON.parse($localStorage.currentUser);\n\n                    $http({\n                        method: 'POST',\n                        url: 'http://localhost/hrm/publicrole',\n                        data:  {name: $scope.role}\n                    }).success(function (data) {\n                        $http({\n                            method: 'POST',\n                            url: 'http://localhost/hrm/public/assign-role',\n                            data: {email: x.email, name: $scope.role}\n                        }).success(function (data) {\n                            $http({\n                                method: 'POST',\n                                url: 'http://localhost/hrm/public/attach-permission',\n                                data: {role: $scope.role, name: $scope.perms}\n                            }).success(function (data) {\n                                console.log(data);\n                            }).error(function (err) {\n                                console.log(err);\n                            });\n                        });\n                    });\n\n                    $mdDialog.hide();\n                };\n                $scope.edit = function (client) {\n                    console.log(client);\n                    $mdDialog.hide(client);\n                };\n            };\n            \n            $scope.serachUser = function (user) {\n                $http({\n                    method: 'POST',\n                    url: 'http://localhost/hrm/public/searchUser',\n                    data: {email: user.email}\n                }).success(function (data) {\n                    console.log(data);\n                    $scope.users = [];\n                    $scope.users.push(data);\n                });\n            }\n\n        }\n\n    ]);\n\n"],"sourceRoot":"/source/"}