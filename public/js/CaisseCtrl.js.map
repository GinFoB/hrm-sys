{"version":3,"sources":["CaisseCtrl.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CaisseCtrl.js","sourcesContent":["/**\n * Created by akramkhalifa on 29/08/2016.\n */\n'use strict';\n\n/**\n * @ngdoc function\n * @name demoApp.controller:IndexCtrl\n * @description\n * # IndexCtrl\n * Controller of the demoApp\n */\nhrmApp\n    .controller('CaisseCtrl',['CaisseService','$http','$mdEditDialog', '$scope','$mdDialog','$timeout','$mdBottomSheet', '$mdToast',\n        function (\n            CaisseService,$http,$mdEditDialog, $scope,$mdDialog, $timeout,$mdBottomSheet, $mdToast) {\n\n            $scope.modes = [\"Virement\", \"Espèce\", \"Chèque\", \"Carte\"];\n\n            $scope.types = [\"D\", \"C\"];\n\n            $scope.id = null;\n            $scope.caisses = [];\n\n            $scope.selected = [];\n            $scope.limitOptions = [5, 10, 15, {\n                label: 'All',\n                value: function () {\n                    return $scope.caisses ? $scope.caisses.count : 0;\n                }\n            }];\n\n            $scope.options = {\n                rowSelection: true,\n                multiSelect: true,\n                autoSelect: true,\n                decapitate: false,\n                largeEditDialog: false,\n                boundaryLinks: false,\n                limitSelect: true,\n                pageSelect: true\n            };\n\n            $scope.query = {\n                order: 'raison',\n                limit: 5,\n                page: 1\n            };\n\n            $scope.myDate = new Date();\n            $scope.firstDay = new Date(new Date().getFullYear(), 0, 1);\n\n\n            $scope.init = function () {\n                CaisseService.getCaisses().$promise.then(function (data) {\n                    $scope.caisses = {\n                        \"count\":data.length,\n                        \"data\":data\n                    };\n                });\n            };\n\n\n            $scope.deselect = function (item) {\n                console.log(item.id,'was deselected');\n            };\n\n            $scope.log = function (item) {\n                console.log(item.id,'was selected');\n                $scope.id = item.id;\n            };\n\n            $scope.loadStuff = function () {\n                $scope.promise = $timeout(function () {\n\n                }, 2000);\n            };\n\n            $scope.toggleLimitOptions = function () {\n                $scope.limitOptions = $scope.limitOptions ? undefined : [5, 10, 15];\n            };\n\n            $scope.loadStuff = function () {\n                $scope.promise = $timeout(function () {\n                    // loading\n                }, 2000);\n            };\n\n            $scope.logPagination = function (page, limit) {\n                console.log('page: ', page);\n                console.log('limit: ', limit);\n            };\n\n            $scope.caisse = {};\n\n            $scope.addCaisse = function (event) {\n                $mdDialog.show({\n                    controller: AddCaisseController,\n                    locals: {\n                        items: $scope.caisses\n                    },\n                    parent: angular.element(document.body),\n                    templateUrl: 'views/caisse/addcaisse.html',\n                    controllerAs: 'ctrl',\n                    clickOutsideToClose:true,\n                    targetEvent: event\n                }).then(function (add) {\n                    $scope.init();\n                   /* $mdToast.show(\n                        $mdToast.simple()\n                            .textContent(\"Caisse ajouté avec succès\")\n                            .position('top right')\n                            .hideDelay(1500)\n                    );\n                    */\n                }, function(cancel) {\n                });\n            };\n\n\n            $scope.showCaisse = function (event) {\n                $mdDialog.show({\n                    locals: {\n                        id: $scope.id\n                    },\n                    controller: function ($mdDialog,$scope,id) {\n                        CaisseService.getCaisse({id: id}).$promise.then(function (data) {\n                            angular.forEach(data,function (value) {\n                                $scope.datas = value;\n                            });\n                        });\n                        $scope.hide = function () {\n                            $mdDialog.hide();\n                        };\n                        $scope.cancel = function () {\n                            $mdDialog.cancel();\n                        };\n                    },\n                    parent: angular.element(document.body),\n                    templateUrl: 'views/caisse/seecaisse.html',\n                    clickOutsideToClose:true,\n                    targetEvent: event\n                });\n            };\n\n\n            $scope.editCaisse = function (event) {\n                $mdDialog.show({\n                    controller: EditCaisseController,\n                    parent: angular.element(document.body),\n                    templateUrl: 'views/caisse/editcaisse.html',\n                    controllerAs: 'ctrl',\n                    locals: {\n                        items: $scope.caisses,id: $scope.id\n                    },\n                    clickOutsideToClose:true,\n                    targetEvent: event\n                }).then(function (edit) {\n                    $scope.init();\n                    /* $mdToast.show(\n                     $mdToast.simple()\n                     .textContent(\"Consultant modifié avec succès\")\n                     .position('top right')\n                     .hideDelay(1500)\n                     );*/\n\n                }, function(cancel) {\n                });\n            };\n\n            function AddCaisseController($scope, $mdDialog,items) {\n                $scope.hide = function () {\n                    $mdDialog.hide();\n                };\n                $scope.cancel = function () {\n                    $mdDialog.cancel();\n                };\n                $scope.add = function (caisse) {\n                    caisse = {\n                        designat : caisse.designat,\n                        date_paiement: caisse.date_paiement ,\n                        mode_paiement: caisse.mode_paiement,\n                        montant: caisse.montant,\n                        ref_paiement: caisse.ref_paiement,\n                        type_opr: caisse.type_opr,\n                        observations: caisse.observations\n                    };\n\n                    if(caisse != null){\n                        CaisseService.saveCaisse(caisse).$promise.then(\n                            function(data) {\n                                items.data.push(data);\n                            },function (data) {\n                                console.log(data);\n                            });\n                        $mdDialog.hide(caisse);\n                    }\n                    else {\n                        console.log('kflnvd');\n                    }\n\n                };\n            };\n\n            function EditCaisseController($scope, $mdDialog,items,id) {\n                $scope.hide = function () {\n                    $mdDialog.hide();\n                };\n                $scope.cancel = function () {\n                    $mdDialog.cancel();\n                };\n\n                CaisseService.getCaisse({id: id}).$promise.then(function (data) {\n                    angular.forEach(data,function (value) {\n                        $scope.datas = value;\n                    })\n                });\n\n                $scope.edit = function (caisse) {\n                    caisse = {\n                        designat : caisse.designat,\n                        date_paiement: caisse.date_paiement,\n                        mode_paiement: caisse.mode_paiement,\n                        montant: caisse.montant,\n                        ref_paiement: caisse.ref_paiement,\n                        type_opr: caisse.type_opr,\n                        observations: caisse.observations\n                    };\n                    CaisseService.editCaisse({id: id},caisse);\n                    $mdDialog.hide(caisse);\n                }\n            }\n\n            $scope.showConfirm = function(ev) {\n                var confirm = $mdDialog.confirm()\n                    .title('Vous voulez vraiment supprimer?')\n                    .textContent('')\n                    .targetEvent(ev)\n                    .ok('Effacer')\n                    .cancel('Annuler');\n                $mdDialog.show(confirm).then(function() {\n                    var index =  $scope.caisses[\"data\"].indexOf(\n                        $scope.caisses[\"data\"].find(function(e) {\n                            return e.id == $scope.id;\n                        }));\n\n                    CaisseService.deleteCaisse({id: $scope.id}).$promise.then(function (success) {\n                        $scope.caisses[\"data\"].splice(index,1);\n                    });\n\n                    $mdToast.show(\n                        $mdToast.simple()\n                            .textContent(\"Caisse a été supprimé\")\n                            .position('top right')\n                            .hideDelay(1500)\n                    );\n                }, function() {\n                });\n            };\n            $scope.init();\n\n            $scope.serachCaisse = function (caisse) {\n                console.log($scope.myDate);\n                $http({\n                    method: 'POST',\n                    url: 'http://localhost/hrm/public/api/serachCaisse',\n                    data:  {myDate: $scope.myDate, firstDay: $scope.firstDay,type:caisse.type_opr}\n                }).success(function (data) {\n                    console.log(data);\n                    if(data != 'caisse not found'){\n                        $scope.caisses[\"data\"] = [];\n                        $scope.caisses[\"data\"].push(data);\n                    }\n                    else {\n                        $scope.init();\n                    }\n\n                }).error(function (data) {\n                    console.log(data);\n                });\n            };\n\n        }\n    ]);\n\n"],"sourceRoot":"/source/"}