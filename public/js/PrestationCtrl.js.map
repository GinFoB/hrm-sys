{"version":3,"sources":["PrestationCtrl.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PrestationCtrl.js","sourcesContent":["/**\n * Created by akramkhalifa on 29/08/2016.\n */\n'use strict';\n\n/**\n * @ngdoc function\n * @name demoApp.controller:IndexCtrl\n * @description\n * # IndexCtrl\n * Controller of the demoApp\n */\nhrmApp\n    .controller('PrestationCtrl',['PrestationService','Upload','$http','$mdEditDialog', '$scope','$mdDialog','$timeout','$mdBottomSheet', '$mdToast',\n        function (\n            PrestationService,Upload,$http,$mdEditDialog, $scope,$mdDialog, $timeout,$mdBottomSheet, $mdToast) {\n\n            $scope.modes = [\"Virement\", \"Espèce\", \"Chèque\", \"Carte\"];\n\n            $scope.yesOrNon = [\"OUI\", \"NON\"];\n\n            $scope.types = [\"D\", \"C\"];\n\n            $scope.id = null;\n            $scope.prestations = [];\n\n            $scope.selected = [];\n            $scope.limitOptions = [5, 10, 15, {\n                label: 'All',\n                value: function () {\n                    return $scope.caisses ? $scope.caisses.count : 0;\n                }\n            }];\n\n            $scope.options = {\n                rowSelection: true,\n                multiSelect: true,\n                autoSelect: true,\n                decapitate: false,\n                largeEditDialog: false,\n                boundaryLinks: false,\n                limitSelect: true,\n                pageSelect: true\n            };\n\n            $scope.query = {\n                order: 'raison',\n                limit: 5,\n                page: 1\n            };\n\n            $scope.missions =  $http({\n                method: 'GET',\n                url: 'http://localhost/hrm/public/api/getAllMissions'\n            }).success(function (data) {\n                $scope.missions = data;\n            }).error(function (data) {\n                console.log(data);\n            });\n\n            $scope.init = function () {\n                PrestationService.getPrestations().$promise.then(function (data) {\n                    $scope.prestations = {\n                        \"count\": data.length,\n                        \"data\": data\n                    };\n                });\n            };\n\n            $scope.deselect = function (item) {\n                console.log(item.id,'was deselected');\n            };\n\n            $scope.log = function (item) {\n                console.log(item.id,'was selected');\n                $scope.id = item.id;\n            };\n\n            $scope.loadStuff = function () {\n                $scope.promise = $timeout(function () {\n\n                }, 2000);\n            };\n\n            $scope.toggleLimitOptions = function () {\n                $scope.limitOptions = $scope.limitOptions ? undefined : [5, 10, 15];\n            };\n\n            $scope.loadStuff = function () {\n                $scope.promise = $timeout(function () {\n                    // loading\n                }, 2000);\n            };\n\n            $scope.logPagination = function (page, limit) {\n                console.log('page: ', page);\n                console.log('limit: ', limit);\n            };\n\n            $scope.caisse = {};\n\n            $scope.addPrestation = function (event) {\n                $mdDialog.show({\n                    controller: AddPrestationController,\n                    locals: {\n                        items: $scope.prestations\n                    },\n                    parent: angular.element(document.body),\n                    templateUrl: 'views/prestation/addprestation.html',\n                    controllerAs: 'ctrl',\n                    clickOutsideToClose:true,\n                    targetEvent: event\n                }).then(function (add) {\n                    $scope.init();\n                     $mdToast.show(\n                     $mdToast.simple()\n                     .textContent(\"Prestation ajouté avec succès\")\n                     .position('top right')\n                     .hideDelay(1500)\n                     );\n                }, function(cancel) {\n                });\n            };\n\n            $scope.showPrestation = function (event) {\n                $mdDialog.show({\n                    locals: {\n                        id: $scope.id\n                    },\n                    controller: function ($mdDialog,$scope,id) {\n                        PrestationService.get({id: id}).$promise.then(function (data) {\n                            console.log(data);\n                            $scope.datas = data;\n                        });\n                        $scope.hide = function () {\n                            $mdDialog.hide();\n                        };\n                        $scope.cancel = function () {\n                            $mdDialog.cancel();\n                        };\n                    },\n                    parent: angular.element(document.body),\n                    templateUrl: 'views/prestation/seeprestation.html',\n                    clickOutsideToClose:true,\n                    targetEvent: event\n                });\n            };\n\n\n\n            $scope.editPrestation = function (event) {\n                $mdDialog.show({\n                    controller: EditPrestationController,\n                    parent: angular.element(document.body),\n                    templateUrl: 'views/prestation/editprestation.html',\n                    locals: {\n                        items: $scope.caisses,id: $scope.id\n                    },\n                    clickOutsideToClose:true,\n                    targetEvent: event\n                }).then(function (edit) {\n                    $scope.init();\n                    /* $mdToast.show(\n                     $mdToast.simple()\n                     .textContent(\"Consultant modifié avec succès\")\n                     .position('top right')\n                     .hideDelay(1500)\n                     );*/\n\n                }, function(cancel) {\n                });\n            };\n\n            function AddPrestationController($scope, $mdDialog,items) {\n                $scope.hide = function () {\n                    $mdDialog.hide();\n                };\n                $scope.cancel = function () {\n                    $mdDialog.cancel();\n                };\n                $scope.add = function (file) {\n                    items.data.push(file);\n                    file.upload = Upload.upload({\n                        url: 'http://localhost/hrm/public/api/prestations',\n                        data: file\n                });\n                    file.upload.then(function (response) {\n                        $timeout(function () {\n                            file.result = response.data;\n                        });\n                    }, function (response) {\n                        if (response.status > 0)\n                            $scope.errorMsg = response.status + ': ' + response.data;\n                    }, function (evt) {\n                        file.progress = Math.min(100, parseInt(100.0 * evt.loaded / evt.total));\n                    });\n                    $mdDialog.hide(file);\n                }\n            };\n\n          function EditPrestationController($scope, $mdDialog,items,id) {\n                $scope.hide = function () {\n                    $mdDialog.hide();\n                };\n                $scope.cancel = function () {\n                    $mdDialog.cancel();\n                };\n                  PrestationService.get({id: id}).$promise.then(function (data) {\n                      console.log(data);\n                      $scope.datas = data;\n                  });\n                $scope.edit = function (file) {\n                    file.upload = Upload.upload({\n                        url: 'http://localhost/hrm/public/api/editPermission/'+id,\n                        data: file\n                    });\n                    file.upload.then(function (response) {\n                        $timeout(function () {\n                            file.result = response.data;\n                        });\n                    }, function (response) {\n                        if (response.status > 0)\n                            $scope.errorMsg = response.status + ': ' + response.data;\n                    }, function (evt) {\n                        file.progress = Math.min(100, parseInt(100.0 * evt.loaded / evt.total));\n                    });\n                    $mdDialog.hide(file);\n                }\n            }\n\n            $scope.showConfirm = function(ev) {\n                var confirm = $mdDialog.confirm()\n                    .title('Vous voulez vraiment supprimer?')\n                    .textContent('')\n                    .targetEvent(ev)\n                    .ok('Effacer')\n                    .cancel('Annuler');\n                $mdDialog.show(confirm).then(function() {\n                    var index =  $scope.prestations[\"data\"].indexOf(\n                        $scope.prestations[\"data\"].find(function(e) {\n                            return e.id == $scope.id;\n                        }));\n\n                    PrestationService.deletePrestation({id: $scope.id}).$promise.then(function (success) {\n                        $scope.prestations[\"data\"].splice(index,1);\n                    });\n\n                    $mdToast.show(\n                        $mdToast.simple()\n                            .textContent(\"Prestation a été supprimé\")\n                            .position('top right')\n                            .hideDelay(1500)\n                    );\n                }, function() {\n                });\n            };\n            $scope.init();\n\n            $scope.serachPrestation = function (prestation) {\n                $http({\n                    method: 'POST',\n                    url: 'http://localhost/hrm/public/api/serachPrestation',\n                    data:  {\n                        mission:prestation.mission,\n                        date_effet:prestation.date_effet,\n                        date_paiement_consultant:prestation.date_paiement_consultant,\n                        date_paiement_client: prestation.date_paiement_client,\n                        prestation_payee:prestation.prestation_payee,\n                        facture_reglee:prestation.facture_reglee\n                    }\n                }).success(function (data) {\n                    console.log(data);\n                    if(data !='Prestation Not Found'){\n                        $scope.prestations[\"data\"] = [];\n                        $scope.prestations[\"data\"].push(data);\n                    }\n                    else {\n                        $scope.init();\n                    }\n\n                }).error(function (data) {\n                    console.log(data);\n                });\n\n                prestation.mission = '';\n                prestation.date_effet = '';\n                prestation.date_paiement_consultant ='';\n                prestation.date_paiement_client='';\n                prestation.prestation_payee='';\n                prestation.facture_reglee='';\n            };\n        }\n    ]);\n\n"],"sourceRoot":"/source/"}